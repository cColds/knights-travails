(()=>{"use strict";const t=new Audio("./assets/piano-move.mp3"),e=new Audio("./assets/piano-check.mp3"),s=new Audio("./assets/piano-capture.mp3"),n=new Audio("./assets/piano-victory.mp3");function o(t){return new Promise((e=>{t.volume=.5,t.onended=()=>e(),t.play()}))}class i{constructor(){this.board=Array.from({length:8},(()=>Array(8).fill(0)))}static isOutOfBounds=([t,e])=>t<0||t>7||e<0||e>7;static isPositionMatching=(t,e)=>JSON.stringify(t)===JSON.stringify(e);static logPath(t){const e=t.length-1==1;console.log(`You made it in ${t.length-1} ${e?"move":"moves"}! Here's your path:`);for(let e=0;e<t.length;e+=1)console.log(t[e])}static isValidMove(t,e){return[t,e].every(Array.isArray)&&[...t,...e].every((t=>Number.isInteger(t)))&&2===t.length&&2===e.length&&!i.isOutOfBounds(t)&&!i.isOutOfBounds(e)}getPossibleMoves(){const[t,e]=this.currentPosition;return[[t+1,e-2],[t+2,e-1],[t+2,e+1],[t+1,e+2],[t-1,e-2],[t-2,e-1],[t-2,e+1],[t-1,e+2]].filter((([t,e])=>!i.isOutOfBounds([t,e])&&0===this.board[t][e]))}getPath(t,[e,s]){const n=[[e,s]];let[o,r]=this.board[e][s];for(;;){if(i.isPositionMatching(t,[o,r])){n.push(t);break}n.push([o,r]),[o,r]=this.board[o][r]}return n.reverse()}move(t=[0,0],e=[0,0]){if(!i.isValidMove(t,e))return void console.log("Invalid move");this.resetBoard();const s=[t];for(this.currentPosition=t,this.board[t[0]][t[1]]=t;!i.isPositionMatching(s[0],e);)s.shift(),this.getPossibleMoves().forEach((([t,e])=>{s.push([t,e]),this.board[t][e]=this.currentPosition})),[this.currentPosition]=s;return this.getPath(t,e)}resetBoard(){this.board=Array.from({length:8},(()=>Array(8).fill(0)))}}const r=document.querySelector(".modal-container"),a=document.querySelector(".modal-heading-text"),c=document.querySelector(".close-modal"),l=document.querySelector(".path"),d=document.querySelector(".new-game"),u=document.querySelector(".resume-game");function h(){r.classList.remove("active")}function g([t,e]){return"abcdefgh"[t]+"12345678"[e]}function m(){document.querySelector(".knight").classList.remove("knight")}c.addEventListener("click",(()=>{m(),h()})),d.addEventListener("click",(()=>{m(),h()})),u.addEventListener("click",h);const f=document.querySelector(".board"),v=new i,y=async t=>new Promise((e=>setTimeout(e,t))),k=(t,e)=>document.querySelector(`[data-coordinates='[${e[t]}]']`);function L(t,e,s){document.querySelectorAll(".trail").forEach((t=>t.classList.remove("trail"))),function(t,e){r.classList.add("active"),function(t){const e=1===t?"move":"moves";a.textContent=`Checkmate in ${t} ${e}`}(t),function(t){let e="";for(let s=0;s<t.length;s+=1){const n=s===t.length-1;e+=s===t.length-2?`${s+1}. N${g(t[s])}+ `:n?`${s+1}. Nx${g(t[s])}# `:`${s+1}. N${g(t[s])} `}l.textContent=e}(e)}(t,e),s.classList.remove("check"),f.classList.remove("disable")}!function(){let t=0;for(let e=7;e>=0;e-=1)for(let s=0;s<8;s+=1)f.children[t].dataset.coordinates=`[${e},${s}]`,t+=1}(),f.addEventListener("click",(async function(r){if(!r.target.classList.contains("square"))return;if(r.target.classList.contains("knight"))return;if(null==document.querySelector(".knight"))return r.target.classList.add("knight"),void(v.currentPosition=JSON.parse(r.target.dataset.coordinates));f.classList.add("disable"),function(t){v.start=v.currentPosition,v.end=JSON.parse(t.target.dataset.coordinates)}(r);const a=document.querySelector(`[data-coordinates='[${v.end}]']`);a.classList.add("king");const c=v.move(v.start,v.end),l=c.length-1;await async function(i){for(let r=0;r<i.length;r+=1){const a=document.querySelector(".knight"),c=k(r,i),l=r===i.length-2;if(a.classList.remove("knight"),c.classList.add("knight","trail"),l){const t=k(r+1,i);t.classList.add("check"),await o(e),o(s),c.classList.remove("knight"),t.classList.add("knight","trail"),y(500).then((()=>{o(n)}));break}await y(500),await o(t)}}(c),a.classList.remove("king"),i.logPath(c),await y(500),v.currentPosition=v.end,v.start=null,v.end=null,L(l,c,a)}))})();